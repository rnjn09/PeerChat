/*
 * Main node class.
 * @ Ranjan Dhar
 */

import java.io.DataOutputStream;
import java.io.IOException;
import java.io.Serializable;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.HashMap;


public class Peer {
	
	
	private String ipAddress;
	private String nodeId;
	private String pingAck = "";
	private PeerUI peerUI;
	private HashMap<String, String> routingTable = new HashMap<String, String>();
	
	
	public Peer(){
		peerUI = new PeerUI(this);
		peerUI.start();
	}
	
	public void communicate(String ipAddress, String message){
		try{
			Socket socket = new Socket(ipAddress, 5949);
			DataOutputStream sendMessage = new DataOutputStream(socket.getOutputStream());
			sendMessage.writeBytes(message + "\n");
			sendMessage.close();
			socket.close();
			
		}catch(Exception e){
			System.out.println("ERROR: Could Open Socket to: " + ipAddress);
		}
	}

	//Main method
	public static void main(String[] args) throws IOException {
		Peer server = new Peer();
		GatewayHandler gateWayHandler = new GatewayHandler(server, new ServerSocket(5949));
		gateWayHandler.start();
	}
	
	//Getters & Setters
	public String getIpAddress() {
		return ipAddress;
	}

	public void setIpAddress(String ipAddress) {
		this.ipAddress = ipAddress;
	}

	public String getNodeId() {
		return nodeId;
	}

	public void setNodeId(String nodeId) {
		this.nodeId = nodeId;
	}

	public String getPingAck() {
		return pingAck;
	}

	public void setPingAck(String pingAck) {
		this.pingAck = pingAck;
	}
}

